<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<title>Literature.exe</title>

<style>
html,body{
margin:0;
height:100%;
overflow:hidden;
font-family:monospace;
color:white;
}

body{
background:url("Club.png") center / cover no-repeat fixed;
}

#overlay{
display:flex;
height:100vh;
}

/* LOGIN */
#loginScreen{
position:absolute;
width:100%;
height:100%;
background:black;
display:flex;
justify-content:center;
align-items:center;
flex-direction:column;
z-index:999;
}

input{
padding:10px;
margin:5px;
border:none;
outline:none;
}

button{
background:black;
color:white;
border:1px solid #ff6fa9;
padding:8px;
cursor:pointer;
}

button:hover{
background:#ff6fa9;
color:black;
}

/* CENTRE */
#main{
flex:1;
display:flex;
flex-direction:column;
justify-content:center;
align-items:center;
}

#logo{
width:360px;
cursor:pointer;
}

.bounce{
animation:bounce .2s;
}

@keyframes bounce{
0%{transform:scale(1)}
50%{transform:scale(.95)}
100%{transform:scale(1)}
}

/* SHOP */
#shop{
width:320px;
background:rgba(0,0,0,.9);
padding:10px;
display:flex;
flex-direction:column;
}

.shopSection{
flex:1;
overflow-y:auto;
}

.upgrade{
border:1px solid #444;
padding:10px;
margin-bottom:10px;
}

/* STATS */
#statsBar{
position:fixed;
bottom:10px;
left:10px;
background:rgba(0,0,0,.85);
border:1px solid #ff6fa9;
padding:10px;
}

/* TOAST */
.toast{
position:fixed;
bottom:90px;
left:10px;
background:rgba(255,105,180,.95);
padding:10px;
border-radius:5px;
opacity:0;
transition:.4s;
}

.toast.show{
opacity:1;
transform:translateY(-10px);
}
</style>
</head>

<body>

<!-- LOGIN -->
<div id="loginScreen">
<h2>Literature.exe</h2>
<input id="username" placeholder="Pseudo">
<input id="password" type="password" placeholder="Mot de passe">
<button onclick="login()">Jouer</button>
</div>

<audio id="music" loop>
<source src="audio/music.mp3">
</audio>

<audio id="clickSound">
<source src="audio/click.mp3">
</audio>

<div id="overlay">

<div id="main">
<img id="logo" src="Logo.png" onclick="clickLiterature()">
<p style="opacity:.6;">Clique sur le logo</p>
</div>

<div id="shop">
<h2>Boutique</h2>

<div class="shopSection">
<h3>üõí Am√©liorations</h3>
<div id="shopItems"></div>
</div>

<div class="shopSection">
<h3>üéÅ Rewards</h3>
<div id="shopRewards"></div>
</div>

<button onclick="exportAllSaves()">üìÅ Exporter toutes les saves</button>

</div>
</div>

<div id="statsBar">
<div id="points">Points : 0</div>
<div id="score">Score : 0</div>
<div id="stats">Par clic : 1 | Auto : 0</div>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js"></script>

<script>

  // Import des modules Firebase
  import { initializeApp } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-app.js";
  import { getFirestore, doc, setDoc, getDoc, getDocs, collection, orderBy, query } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore.js";

  const firebaseConfig = {
    apiKey: "TON_API_KEY",
    authDomain: "TON_PROJECT.firebaseapp.com",
    projectId: "TON_PROJECT_ID",
    storageBucket: "TON_PROJECT.appspot.com",
    messagingSenderId: "TON_SENDER_ID",
    appId: "TON_APP_ID"
  };

  const app = initializeApp(firebaseConfig);
  const db = getFirestore(app);

  window.db = db; // Pour pouvoir l‚Äôutiliser ailleurs

/* ================= PLAYER ================= */

let totalClicks = 0;

let player="";
let saveKey="";

let points=0;
let score=0;
let perClick=1;
let passive=0;
let totalPointsGained=0;
let musicStarted=false;

/* ================= UPGRADES ================= */

const upgrades=[
  {name:"‚úíÔ∏è Stylo", cost:50, perClick:0.5, passive:0},
  {name:"üìì Po√®me", cost:250, perClick:2, passive:0},
  {name:"üñãÔ∏è Stylo plume", cost:1200, perClick:5, passive:0},
  {name:"üìñ Recueil de po√®mes", cost:4500, perClick:10, passive:0.5},
  {name:"üìù Carnet reli√©", cost:12000, perClick:18, passive:1},
  {name:"üìö Anthologie", cost:35000, perClick:35, passive:2},
  {name:"üñ•Ô∏è Traitement de texte", cost:90000, perClick:70, passive:4},
  {name:"‚å®Ô∏è Clavier m√©canique", cost:180000, perClick:120, passive:8},
  {name:"üìú Manuscrit ancien", cost:350000, perClick:200, passive:12},
  {name:"üèõÔ∏è Biblioth√®que personnelle", cost:600000, perClick:350, passive:20},
  {name:"üß† Inspiration divine", cost:1500000, perClick:550, passive:35},
  {name:"üå∏ Influence de Sayori", cost:3000000, perClick:850, passive:50},
  {name:"üíú Regard de Yuri", cost:6000000, perClick:1400, passive:80},
  {name:"üéº Harmonie de Natsuki", cost:12000000, perClick:2300, passive:150},
  {name:"üìò Conscience de Monika", cost:25000000, perClick:4000, passive:250},
  {name:"üíæ Script auto-√©crit", cost:50000000, perClick:7000, passive:400},
  {name:"üåå R√©alit√© alt√©r√©e", cost:60000000, perClick:9000, passive:600},
  {name:"ü©∏ Fichier corrompu", cost:70000000, perClick:13000, passive:800},
  {name:"üï≥Ô∏è Br√®che du jeu", cost:75000000, perClick:20000, passive:1200},
  {name:"üëÅÔ∏è Observateur", cost:80000000, perClick:30000, passive:1600},
  {name:"üíø Codex interdit", cost:85000000, perClick:40000, passive:2000},
  {name:"üîÆ Vision du futur", cost:88000000, perClick:50000, passive:2500},
  {name:"üì¶ Coffre scell√©", cost:91000000, perClick:60000, passive:3000},
  {name:"üñ§ Fragment de l‚Äôombre", cost:94000000, perClick:70000, passive:3500},
  {name:"‚ö° √âclair de Monika", cost:96000000, perClick:80000, passive:4000},
  {name:"üå∫ Fleur corrompue", cost:97000000, perClick:90000, passive:4500},
  {name:"üí° Id√©e divine", cost:98000000, perClick:100000, passive:5000},
  {name:"üïπÔ∏è Simulateur de destin", cost:98500000, perClick:120000, passive:5500},
  {name:"üìå Point final", cost:99000000, perClick:140000, passive:6000},
  {name:"üéá Explosion de mots", cost:99200000, perClick:160000, passive:6500},
  {name:"üí´ Constellation litt√©raire", cost:99400000, perClick:180000, passive:7000},
  {name:"üìñ Tome ultime", cost:99600000, perClick:200000, passive:7500},
  {name:"üåü Inspiration infinie", cost:99800000, perClick:250000, passive:8000},
  {name:"üíª Script omnipotent", cost:99900000, perClick:300000, passive:9000},
  {name:"üåå Univers parall√®le", cost:99950000, perClick:400000, passive:10000},
  {name:"üß¨ Manipulation du temps", cost:99970000, perClick:500000, passive:12000},
  {name:"üï≥Ô∏è Singularit√©", cost:99985000, perClick:600000, passive:15000},
  {name:"üëÅÔ∏è ≈íil du Cr√©ateur", cost:99990000, perClick:700000, passive:20000},
  {name:"üèÜ Ma√Ætre de la litt√©rature", cost:100000000, perClick:1000000, passive:25000},
  {name:"üñ•Ô∏è Serveur instable", cost:120000000, perClick:1000000, passive:25000},
  {name:"üíæ Fichier corrompu", cost:140000000, perClick:1500000, passive:35000},
  {name:"üñß R√©seau satur√©", cost:160000000, perClick:2000000, passive:50000},
  {name:"üìÇ Partition endommag√©e", cost:180000000, perClick:2500000, passive:75000},
  {name:"üõ†Ô∏è Script automatique", cost:200000000, perClick:4000000, passive:100000},
  {name:"üíª Compilation glitch√©e", cost:230000000, perClick:6000000, passive:125000},
  {name:"üóÑÔ∏è Base de donn√©es corrompue", cost:260000000, perClick:8000000, passive:150000},
  {name:"üß© Module instable", cost:300000000, perClick:10000000, passive:200000},
  {name:"üñ±Ô∏è Macro ultra-rapide", cost:340000000, perClick:15000000, passive:300000},
  {name:"üìº Backup endommag√©", cost:380000000, perClick:20000000, passive:350000},
  {name:"‚öôÔ∏è Kernel modifi√©", cost:420000000, perClick:25000000, passive:400000},
  {name:"üìü Proxy satur√©", cost:460000000, perClick:30000000, passive:500000},
  {name:"üóÉÔ∏è Serveur ma√Ætre", cost:500000000, perClick:40000000, passive:600000}
];


/* ================= REWARDS ================= */

let rewards=[
{id:"YURI",name:"üíæ YURI.chr",cost:10000,type:"BLK",amount:1000,purchased:false,code:null}
];

/* ================= ACHIEVEMENTS ================= */

let purchasePoemCount = 0;
let achievements = [

/* POINTS GAGN√âS */

{ id:"first_click", 
  name:"Premiers mots", 
  description:"Gagner 10 points", 
  goal:10, 
  type:"points",
  pointsBonus:0.1,
  unlocked:false
},

{ id:"writer_1", name:"Jeune √âcrivain", description:"Gagner 1 000 points", goal:1000, type:"points", pointsBonus:0.5, unlocked:false },
{ id:"writer_2", name:"√âcrivain ? Cliqueur d√©butant", description:"Gagner 10 000 points", goal:10000, type:"points", pointsBonus:1.0, unlocked:false },
{ id:"writer_3", name:"Cliqueur Obstin√©", description:"Gagner 50 000 points", goal:50000, type:"points", pointsBonus:5.0, unlocked:false },
{ id:"writer_4", name:"Cliqueur Fou", description:"Gagner 100 000 points", goal:100000, type:"points", pointsBonus:10.0, unlocked:false },
{ id:"writer_5", name:"Cliqueur Enrag√©", description:"Gagner 500 000 points", goal:500000, type:"points", pointsBonus:25.0, unlocked:false },
{ id:"writer_6", name:"Cliqueur ? Non... Spameur !", description:"Gagner 1 000 000 points", goal:1000000, type:"points", pointsBonus:50.0, unlocked:false },
{ id:"writer_7", name:"Spameur D√©butant", description:"Gagner 2 000 000 points", goal:2000000, type:"points", pointsBonus:100.0, unlocked:false },
{ id:"writer_8", name:"Spameur Obstin√©", description:"Gagner 5 000 000 points", goal:5000000, type:"points", pointsBonus:250.0, unlocked:false },
{ id:"writer_9", name:"Spameur D√©termin√©", description:"Gagner 10 000 000 points", goal:10000000, type:"points", pointsBonus:500.0, unlocked:false },
{ id:"writer_10", name:"Spameur Fou", description:"Gagner 15 000 000 points", goal:15000000, type:"points", pointsBonus:750.0, unlocked:false },
{ id:"writer_11", name:"Spameur Enrag√©", description:"Gagner 30 000 000 points", goal:30000000, type:"points", pointsBonus:1500.0, unlocked:false },
{ id:"writer_12", name:"Spameur ? Non... PÃ¥lÃ∑aÃ∂yÃ∏eÃ∏rÃ∏", description:"Gagner 50 000 000 points", goal:50000000, type:"points", pointsBonus:2500.0, unlocked:false },

/* ACHAT */

{ id:"poet", 
  name:"Po√®te", 
  description:"Acheter un po√®me", 
  goal:1,
  type:"purchase_poem",
  pointsBonus:0.2,
  unlocked:false
}

];


function checkAchievements(){

achievements.forEach(a=>{

if(a.unlocked) return;

switch(a.type){

case "points":
if(totalPointsGained >= a.goal){
unlockAchievement(a);
}
break;

case "clicks":
if(totalClicks >= a.goal){
unlockAchievement(a);
}
break;

case "purchase_poem":
if(purchasePoemCount >= a.goal){
unlockAchievement(a);
}
break;

}

});

}


function unlockAchievement(a){

a.unlocked = true;

/* BONUS SCORE */
score += a.pointsBonus;

toast("üèÜ Achievement d√©bloqu√© : " + a.name);

saveGame();
}



/* ================= LOGIN ================= */

function login(){

const u=document.getElementById("username").value;
const p=document.getElementById("password").value;

if(!u||!p)return alert("Entre un pseudo et un mot de passe");

player=u;
saveKey="ddlc_"+CryptoJS.SHA256(u+p).toString();

loadGame();

document.getElementById("loginScreen").style.display="none";

renderShop();
updateUI();
}

/* ================= SAVE ================= */

function saveGame(){

const data={
points,
score,
perClick,
passive,
totalPointsGained,
totalClicks,
rewards,
achievements,
purchasePoemCount
};

localStorage.setItem(saveKey,JSON.stringify(data));
}

/* ================= LOAD ================= */

function loadGame(){

const save=localStorage.getItem(saveKey);

if(!save)return;

const d=JSON.parse(save);

points=d.points||0;
score=d.score||0;
perClick=d.perClick||1;
passive=d.passive||0;
totalPointsGained=d.totalPointsGained||0;
rewards=d.rewards||rewards;
totalClicks=d.totalClicks||0;
achievements=d.achievements||achievements;
purchasePoemCount = d.purchasePoemCount || 0;

}

/* ================= EXPORT ================= */

function exportAllSaves(){

let all={};

for(let i=0;i<localStorage.length;i++){

const k=localStorage.key(i);

if(k.startsWith("ddlc_")){
all[k]=JSON.parse(localStorage.getItem(k));
}

}

const blob=new Blob([JSON.stringify(all,null,2)],{type:"application/json"});
const a=document.createElement("a");

a.href=URL.createObjectURL(blob);
a.download="players_saves.json";
a.click();
}

/* ================= CLICK ================= */

function clickLiterature(){

const sound=document.getElementById("clickSound");
const music=document.getElementById("music");

sound.currentTime=0;
sound.play();

if(!musicStarted){
music.volume=.4;
music.play();
musicStarted=true;
}

totalClicks++; // ‚≠ê IMPORTANT

points+=perClick;
totalPointsGained+=perClick;

if(totalPointsGained>=100){
score++;
score = Math.floor(totalPointsGained / 100);
}

checkAchievements();
updateUI();
saveGame();
}


/* ================= SHOP ================= */

function renderShop(){

const shop=document.getElementById("shopItems");
shop.innerHTML="";

upgrades.forEach((up,i)=>{

const div=document.createElement("div");
div.className="upgrade";

div.innerHTML=`
<strong>${up.name}</strong><br>
+${up.perClick} clic | +${up.passive}/sec<br>
Co√ªt : ${up.cost}<br>
<button onclick="buyUpgrade(${i})">Acheter</button>
`;

shop.appendChild(div);
});

const rdiv=document.getElementById("shopRewards");
rdiv.innerHTML="";

rewards.forEach((r,i)=>{

const div=document.createElement("div");
div.className="upgrade";

div.innerHTML=`
<strong>${r.name}</strong><br>
${r.purchased?`Code:<br><small>${r.code}</small>`:`Co√ªt : ${r.cost}`}
<button ${r.purchased?"disabled":""} onclick="buyReward(${i})">
${r.purchased?"D√©bloqu√©":"Acheter"}
</button>
`;

rdiv.appendChild(div);
});

}

/* ================= BUY ================= */

function buyUpgrade(i){

const up=upgrades[i];

if(points<up.cost)return;

    if(up.name.includes("Po√®me")){
    purchasePoemCount++;
    }

points-=up.cost;
perClick+=up.perClick;
passive+=up.passive;
score+=Math.floor(up.cost/1000);

toast("Am√©lioration achet√©e");

checkAchievements();
updateUI();
saveGame();
}

function buyReward(i){

const r=rewards[i];

if(points<r.cost||r.purchased)return;

points-=r.cost;
r.purchased=true;

r.code=CryptoJS.AES.encrypt(
`DDLC|${r.id}|PLAYER=${player}|TYPE=${r.type}|AMOUNT=${r.amount}`,
"oOP57oD8z7uw-Y8aiGC-7l7RCuebt-n9JquIHbxovUk="
).toString();

toast("Reward d√©bloqu√©e !");
renderShop();
saveGame();
}

/* ================= PASSIVE ================= */

setInterval(()=>{

if(passive>0){
points+=passive;
checkAchievements();
updateUI();
saveGame();
}

},1000);

/* ================= UI ================= */

function updateUI(){

document.getElementById("points").innerText="Points : "+Math.floor(points);
document.getElementById("score").innerText="Score : "+score;
document.getElementById("stats").innerText=`Par clic : ${perClick} | Auto : ${passive}`;
}

/* ================= TOAST ================= */

function toast(msg){

const t=document.createElement("div");
t.className="toast";
t.innerText=msg;

document.body.appendChild(t);

setTimeout(()=>t.classList.add("show"),50);
setTimeout(()=>t.remove(),3000);
}

</script>
</body>
</html>
