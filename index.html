<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<title>Literature.exe</title>

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-functions-compat.js"></script>

<style>
body {
  margin:0;
  font-family: monospace;
  background:url("Club.png") center/cover fixed;
  color:white;
}
#overlay { background:rgba(0,0,0,.65); min-height:100vh; display:flex; }
#left { width:260px; background:#000c; padding:10px; }
#main { flex:1; text-align:center; }
#right { width:300px; background:#000c; padding:10px; }

button { background:#1a1a1a; color:white; border:1px solid #ff6fa9; padding:8px; cursor:pointer; }
button:disabled { opacity:.4; cursor:not-allowed; }
.reward { border:1px solid #555; padding:8px; margin-bottom:8px; }
.codeBox { background:#111; padding:6px; word-break:break-all; margin-top:5px; }
.toast {
  position:fixed; bottom:20px; right:20px;
  background:#ff6fa9; color:black;
  padding:10px 15px; border-radius:6px;
  animation:fade 4s forwards;
}
@keyframes fade {
  0%{opacity:0;transform:translateY(10px)}
  10%{opacity:1}
  90%{opacity:1}
  100%{opacity:0;transform:translateY(10px)}
}
</style>
</head>

<body>

<div id="overlay">

<div id="left">
  <h3>üèÜ Classement</h3>
  <ol id="leaderboard"></ol>
</div>

<div id="main">
  <img src="Logo.png" width="350"><br><br>
  <div id="points">0 PL</div>
  <button onclick="clickLiterature()">CLIC</button>
</div>

<div id="right">
  <h3>üõí Am√©liorations</h3>
  <div id="shop"></div>

  <h3>üéÅ R√©compenses</h3>
  <div id="rewards"></div>

  <h3>üéüÔ∏è Codes obtenus</h3>
  <div id="codes"></div>
</div>

</div>

<script>
/* üî• Firebase config */
firebase.initializeApp({
  apiKey: "TA_API_KEY",
  authDomain: "dokidokilitteratureclub-61b4c.firebaseapp.com",
  projectId: "dokidokilitteratureclub-61b4c"
});

const db = firebase.firestore();
const functions = firebase.functions();

/* üë§ Joueur */
let player = localStorage.getItem("player");
if(!player){
  player = prompt("Pseudo :");
  localStorage.setItem("player", player);
}

/* üéÆ Stats */
let points = 0;
let perClick = 1;
let passive = 0;
let ownedRewards = JSON.parse(localStorage.getItem("rewards")||"{}");

/* üõçÔ∏è Upgrades */
const upgrades = [
  { id:"pen", name:"‚úíÔ∏è Stylo", cost:50, perClick:1 },
  { id:"poem", name:"üìì Po√®me", cost:250, perClick:5 }
];

/* üéÅ R√©compenses */
const rewards = [
  { id:"YURI", name:"ü©∏ Yuri.chr", cost:10000, rewardType:"BLK", rewardAmount:1000 }
];

function toast(msg){
  const t=document.createElement("div");
  t.className="toast"; t.innerText=msg;
  document.body.appendChild(t);
  setTimeout(()=>t.remove(),4000);
}

function clickLiterature(){
  points+=perClick;
  document.getElementById("points").innerText = points+" PL";
}

function renderShop(){
  const s=document.getElementById("shop");
  upgrades.forEach(u=>{
    const b=document.createElement("button");
    b.innerText=`${u.name} (${u.cost})`;
    b.onclick=()=>{ if(points>=u.cost){points-=u.cost; perClick+=u.perClick; toast("Am√©lioration achet√©e");}};
    s.appendChild(b);
  });
}

function renderRewards(){
  const r=document.getElementById("rewards");
  r.innerHTML="";
  rewards.forEach(rew=>{
    const d=document.createElement("div");
    d.className="reward";
    const owned=ownedRewards[rew.id];
    d.innerHTML=`<strong>${rew.name}</strong><br>Co√ªt:${rew.cost}<br>`;
    const b=document.createElement("button");
    b.innerText=owned?"D√©j√† d√©bloqu√©":"D√©bloquer";
    b.disabled=owned;
    b.onclick=()=>buyReward(rew);
    d.appendChild(b);
    r.appendChild(d);
  });
}

async function buyReward(rew){
  if(points<rew.cost) return;
  const generate = functions.httpsCallable("generateRewardCode");
  const res = await generate({
    player,
    rewardId: rew.id,
    type: rew.rewardType,
    amount: rew.rewardAmount
  });
  ownedRewards[rew.id]=res.data.code;
  localStorage.setItem("rewards",JSON.stringify(ownedRewards));
  showCodes();
  renderRewards();
  toast("üéÅ R√©compense d√©bloqu√©e !");
}

function showCodes(){
  const c=document.getElementById("codes");
  c.innerHTML="";
  for(const id in ownedRewards){
    c.innerHTML+=`<div class="codeBox">${ownedRewards[id]}</div>`;
  }
}

renderShop();
renderRewards();
showCodes();
</script>

</body>
</html>
